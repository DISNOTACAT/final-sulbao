<!DOCTYPE html>
<html lang="ko"
 xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>회원가입 - 술기로운한잔</title>
  <link rel="stylesheet" href="/user/css/login-style.css">
  <style>
    .verification-message {
      font-size: 10px;
      color: green;
      display: none;
      margin-top: 5px;
    }
    .error-message {
      font-size: 10px;
      color: red;
      margin-top: 5px;
    }
    .error-message-default {
      font-size: 10px;
      color: red;
      margin-top: 5px;
      display: none;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="card">
    <header>
      <h1>술기로운한잔</h1>
    </header>

    <div class="tab-menu">
      <button class="tab active">판매자회원</button>
    </div>

    <form id="business" class="form-content active" action="/regist/seller" method="POST">
      <div class="form-group">
        <label for="business-name">사업자명</label>
        <input type="text" id="business-name" name="businessName" placeholder="사업자명 입력" required>
      </div>

      <div class="form-group">
        <label for="business-number">사업자등록번호</label>
        <div class="verification-wrapper">
          <input type="text" id="business-number" name="businessNumber" placeholder="-없이 숫자만 입력" required>
          <button id="verification-number" type="button" onclick="">사업자번호 인증</button>
        </div>
        <div>
          <p id="business-number-verification-true" class="verification-message" th:text="${valid_businessNumber}">사업자등록번호 조회 완료</p>
        </div>
      </div>

      <div class="form-group">
        <label for="business-phone">휴대폰번호</label>
        <input type="text" id="business-phone" name="businessPhone" placeholder="-없이 숫자만 입력" required>
        <div>
          <p id="business-phone-error-message" class="error-message" th:text="${valid_businessPhone}"></p>
        </div>
      </div>

      <div class="form-group">
        <label for="business-email">이메일</label>
        <div class="verification-wrapper">
          <input type="email" id="business-email" name="businessEmail" placeholder="이메일 주소를 입력해 주세요." required>
          <button id="verification-email" type="button">인증번호 요청</button>
        </div>
        <div id="business-email-verification" class="verification-message">
          <p id="business-email-verification-false" class="error-message-default"></p>  <!-- 인증번호 타이머 필요.. -->
        </div>
            <div class="verification-input-wrapper" id="business-verification-section">
              <input type="text" id="business-verification-email-code" name="businessEmailCode" placeholder="인증코드 입력" required>
              <button id="verification-email-send-btn" type="button" >인증코드 확인</button>
            </div>
            <div id="business-email-verification-code" class="verification-message">
              <p id="business-verification-code-true" class="verification-message" th:text="${valid_ConfirmEmail}"></p>
            </div>
      </div>

      <div class="form-group">
        <label for="business-id">아이디</label>
        <input type="text" id="business-id" name="businessId" placeholder="영어 소문자 및 숫자로만, 4~16자리로 가능합니다." required>
        <div>
          <p id="business-id-error-message" class="error-message" th:text="${valid_businessId}"></p>
        </div>
      </div>

      <div class="form-group">
        <label for="business-password">비밀번호</label>
        <input type="password" id="business-password" name="businessPw" placeholder="영어, 숫자, 특수문자 조합 8~16자리로 가능합니다." required>
        <div><p id="business-pw-error-message" class="error-message" th:text="${valid_businessPw}"></p></div>
      </div>

      <div class="form-group">
        <label for="business-confirm-password">비밀번호 확인</label>
        <input type="password" id="business-confirm-password" name="confirmPw" placeholder="비밀번호 확인" required>
        <div><p id="confirm-pw-error-message" class="error-message" th:text="${valid_confirmPw}"></p></div>

      </div>

      <div class="form-group">
        <br>
        <label class="font-weight-bold">약관동의</label>
        <div class="agree-content-text">
          <hr class="custom-hr">
          <label for="business-agree">
            <input class="sub-content" type="checkbox" id="business-agree" name="agree" required>
            [필수] 술기로운한잔 이용 약관에 동의합니다.</label>
        </div>
      </div>

      <button id="business-submit" type="submit" class="submit-button">가입하기</button>
    </form>

    <div class="additional-links">
      <p>이미 술기로운한잔 계정이 있으신가요? <a href="/login">로그인하기</a></p>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  document.getElementById('verification-number').addEventListener('click', function () {
    var businessNumberInput = document.getElementById('business-number');
    var businessNumber = businessNumberInput.value;

    // 사업자등록번호가 10자리 숫자인지 확인
    var isValid = /^\d{10}$/.test(businessNumber);

    if (!isValid) {
      // 유효하지 않으면 에러 메시지를 표시하고 버튼 동작 중지
      alert("유효한 사업자등록번호를 입력해주세요.");
    } else {
      // 유효한 경우의 버튼 동작을 여기에 추가합니다.
      alert("가입 가능한 사업자등록번호입니다.");
      // 실제 동작 코드를 여기에 추가하세요.
    }
  });

  document.getElementById('verification-email').addEventListener('click', function () {
    var businessEmailInput = document.getElementById('business-email');
    var businessEmail = businessEmailInput.value;

    // 이메일 주소 유효성 확인
    var isValidEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(businessEmail);

    if (!isValidEmail) {
      alert("유효한 이메일주소를 입력해주세요.");
    } else {
      $.ajax({
        url: '/email',
        type: 'POST',
        data: {businessEmail: businessEmail},
        success: function (response) {
          // 서버 응답이 성공적일 때의 동작을 여기에 추가합니다.
          alert("이메일로 인증코드를 전송했습니다.");
          // 추가로 인증 코드를 입력하는 필드와 타이머 등을 표시할 수 있습니다.
        },
        error: function (error) {
          // 서버 응답이 실패했을 때의 동작을 여기에 추가합니다.
          alert("인증코드 전송에 실패했습니다. 다시 시도해주세요.");
        }
      });
    }
  });
</script>
</body>
</html>
